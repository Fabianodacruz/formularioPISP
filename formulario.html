<script>
    document.getElementById("examForm").addEventListener("submit", function(event) {
      event.preventDefault();
      
      const formData = new FormData(this);
      const object = {};
      formData.forEach((value, key) => {
        object[key] = value;
      });
      const json = JSON.stringify(object);
      
      // Substitua 'SUA_URL_DO_WEBAPP' pela URL gerada no Apps Script
      fetch("https://script.google.com/macros/s/AKfycbyXR0BjeXlzaE3W_Au7bbqGt08YiuXnvCQ1TkU9ibIZf7Z6jpuGRn0bvj0PdQTF2WTX", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: json
      })
      .then(response => response.json())
      .then(data => {
        if(data.result === 'success') {
          alert("Resposta registrada com sucesso!");
          // Opcional: Limpar o formulário
          document.getElementById("examForm").reset();
        } else {
          alert("Ocorreu um erro: " + data.message);
        }
      })
      .catch(error => {
        console.error("Erro:", error);
        alert("Erro ao enviar os dados.");
      });
    });
    
    function doGet(e) {
          return ContentService.createTextOutput("Este aplicativo suporta apenas requisições POST.");
}

    

  </script>
  
function doGet(e) {
  return ContentService.createTextOutput("Este aplicativo suporta apenas requisições POST.");
}

<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Questionário de Exames Periciais e de Localística</title>
  <!-- Importando a fonte Roboto -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    /* Estilos gerais inspirados no Google Forms */
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      background: #fff;
      margin: 50px auto;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1, h2 {
      text-align: center;
      font-weight: 400;
    }
    h1 {
      margin-bottom: 20px;
    }
    h2 {
      margin-top: 40px;
      margin-bottom: 20px;
      border-bottom: 2px solid #dadce0;
      padding-bottom: 5px;
    }
    .question {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #e0e0e0;
    }
    .question:last-child {
      border-bottom: none;
    }
    /* Rótulo principal de cada exame com ícone de informação */
    .exam-label {
      font-size: 18px;
      font-weight: 500;
      display: flex;
      align-items: center;
    }
    .info-icon {
      display: inline-block;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background-color: #4285f4;
      color: #fff;
      font-size: 12px;
      line-height: 18px;
      text-align: center;
      margin-left: 8px;
      cursor: pointer;
    }
    /* Container para o campo "Quantidade:" e o input */
    .field {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 8px;
    }
    .field-label {
      font-size: 16px;
      min-width: 100px;
    }
    /* Input com largura fixa para 6 caracteres */
    .field input[type="text"] {
      width: 6ch;
      padding: 5px;
      font-size: 16px;
      text-align: center;
      border: 1px solid #dadce0;
      border-radius: 4px;
    }
    button {
      display: block;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      color: #fff;
      background-color: #4285f4;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 20px;
      transition: background-color 0.2s ease;
    }
    button:hover {
      background-color: #357ae8;
    }
    #result {
      margin-top: 30px;
      padding: 20px;
      background-color: #e8f0fe;
      border: 1px solid #c6dafc;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Questionário de Exames</h1>
    
    <!-- Seção 1: Exames Periciais -->
    <h2>Exames Periciais</h2>
    <form id="examForm">
      <!-- Exame 1: Lesões Corporais (Corpo de Delito) -->
      <div class="question">
        <label class="exam-label" for="exame1">
          Exame de Lesões Corporais (Corpo de Delito)
          <span class="info-icon" title="Avaliação física para verificar a presença, gravidade e natureza das lesões, conforme o art. 129 do CP. Realizado em vítimas de agressões ou acidentes.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame1">Quantidade:</label>
          <input type="text" id="exame1" name="exame1" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 2: Lesões Corporais "Ad Cautelam" -->
      <div class="question">
        <label class="exam-label" for="exame2">
          Exame de Lesões Corporais "Ad Cautelam"
          <span class="info-icon" title="Exame preventivo para registrar a presença ou ausência de lesões em pessoas detidas ou envolvidas em ocorrências policiais.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame2">Quantidade:</label>
          <input type="text" id="exame2" name="exame2" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 3: Lesões Corporais (DPVAT) -->
      <div class="question">
        <label class="exam-label" for="exame3">
          Exame de Lesões Corporais (DPVAT)
          <span class="info-icon" title="Exame para comprovar lesões decorrentes de acidentes de trânsito, subsidiando pedidos baseados no DPVAT.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame3">Quantidade:</label>
          <input type="text" id="exame3" name="exame3" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 4: Lesões Corporais (Odontológico) -->
      <div class="question">
        <label class="exam-label" for="exame4">
          Exame de Lesões Corporais (Odontológico)
          <span class="info-icon" title="Análise de lesões na região bucal e nos dentes realizada por odontolegistas para determinar a extensão do dano.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame4">Quantidade:</label>
          <input type="text" id="exame4" name="exame4" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 5: Verificação de Violência Sexual -->
      <div class="question">
        <label class="exam-label" for="exame5">
          Exame para Verificação de Violência Sexual
          <span class="info-icon" title="Procedimento para comprovar a ocorrência de violência sexual.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame5">Quantidade:</label>
          <input type="text" id="exame5" name="exame5" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 6: Verificação de Aborto -->
      <div class="question">
        <label class="exam-label" for="exame6">
          Exame para Verificação de Aborto
          <span class="info-icon" title="Exame que identifica sinais indicativos de aborto, seja voluntário ou forçado.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame6">Quantidade:</label>
          <input type="text" id="exame6" name="exame6" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 7: Exames em Prontuários Médicos -->
      <div class="question">
        <label class="exam-label" for="exame7">
          Exames em Prontuários Médicos
          <span class="info-icon" title="Análise documental de registros médicos para esclarecer informações periciais.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame7">Quantidade:</label>
          <input type="text" id="exame7" name="exame7" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 8: Necropsia -->
      <div class="question">
        <label class="exam-label" for="exame8">
          Exame de Necropsia
          <span class="info-icon" title="Autópsia realizada para determinar a causa da morte e outros elementos periciais.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame8">Quantidade:</label>
          <input type="text" id="exame8" name="exame8" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 9: Psiquiátrico (Sanidade Mental) -->
      <div class="question">
        <label class="exam-label" for="exame9">
          Exame Psiquiátrico (Sanidade Mental)
          <span class="info-icon" title="Avaliação para verificar a capacidade mental e responsabilidade penal.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame9">Quantidade:</label>
          <input type="text" id="exame9" name="exame9" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 10: Dependência Toxicológica -->
      <div class="question">
        <label class="exam-label" for="exame10">
          Exame de Dependência Toxicológica
          <span class="info-icon" title="Avalia a dependência de substâncias psicoativas com análise clínica e laboratorial.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame10">Quantidade:</label>
          <input type="text" id="exame10" name="exame10" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame 11: Identificação Humana pelos Arcos Dentais -->
      <div class="question">
        <label class="exam-label" for="exame11">
          Identificação Humana pelos Arcos Dentais
          <span class="info-icon" title="Utiliza a arcada dentária para identificar vítimas quando outros métodos não são eficazes.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="exame11">Quantidade:</label>
          <input type="text" id="exame11" name="exame11" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>

      <!-- Seção 2: Exames de Localística -->
      <h2>Exames de Localística</h2>
      <!-- Exame de Local: Acidente de Trânsito com Morte -->
      <div class="question">
        <label class="exam-label" for="local1">
          Exame em Local de Acidente de Trânsito com Morte
          <span class="info-icon" title="Análise da cena de colisões que resultaram em óbito, com coleta de vestígios, medições e documentação das condições da via e dos veículos.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local1">Quantidade:</label>
          <input type="text" id="local1" name="local1" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Atropelamento com Morte -->
      <div class="question">
        <label class="exam-label" for="local2">
          Exame em Local de Atropelamento com Morte
          <span class="info-icon" title="Realizado em casos de atropelamentos fatais, focando na posição da vítima, sinais de impacto e marcas na via.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local2">Quantidade:</label>
          <input type="text" id="local2" name="local2" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Acidente de Trânsito sem Morte – Danos Materiais -->
      <div class="question">
        <label class="exam-label" for="local3">
          Exame em Local de Acidente de Trânsito sem Morte – Danos Materiais
          <span class="info-icon" title="Avaliação de acidentes que causaram apenas danos materiais, com registro de marcas de frenagem e posicionamento dos veículos.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local3">Quantidade:</label>
          <input type="text" id="local3" name="local3" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Incêndio com Morte -->
      <div class="question">
        <label class="exam-label" for="local4">
          Exame em Local de Incêndio com Morte
          <span class="info-icon" title="Investigação de locais com incêndios fatais, identificando a origem do fogo, possíveis causas e a condição das vítimas.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local4">Quantidade:</label>
          <input type="text" id="local4" name="local4" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Incêndio sem Morte -->
      <div class="question">
        <label class="exam-label" for="local5">
          Exame em Local de Incêndio sem Morte
          <span class="info-icon" title="Destinado a incêndios sem vítimas fatais, com foco em danos materiais e análise de resíduos inflamáveis ou estruturais.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local5">Quantidade:</label>
          <input type="text" id="local5" name="local5" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Fuga de Preso -->
      <div class="question">
        <label class="exam-label" for="local6">
          Exame em Local de Fuga de Preso
          <span class="info-icon" title="Análise do local de fuga de um preso, verificando rotas de fuga, danos em estruturas e coleta de evidências.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local6">Quantidade:</label>
          <input type="text" id="local6" name="local6" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Acidente de Trabalho com Morte -->
      <div class="question">
        <label class="exam-label" for="local7">
          Exame em Local de Acidente de Trabalho com Morte
          <span class="info-icon" title="Realizado em acidentes fatais no ambiente laboral, investigando condições de segurança, equipamentos e possíveis falhas.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local7">Quantidade:</label>
          <input type="text" id="local7" name="local7" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Desabamento/Soterramento -->
      <div class="question">
        <label class="exam-label" for="local8">
          Exame em Local de Desabamento/Soterramento
          <span class="info-icon" title="Análise de estruturas colapsadas ou locais de soterramento, com coleta de dados sobre a dinâmica do evento e identificação de vítimas.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local8">Quantidade:</label>
          <input type="text" id="local8" name="local8" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Explosão -->
      <div class="question">
        <label class="exam-label" for="local9">
          Exame em Local de Explosão
          <span class="info-icon" title="Avaliação de áreas com explosões, buscando fragmentos, resíduos químicos e analisando as condições do incidente.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local9">Quantidade:</label>
          <input type="text" id="local9" name="local9" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Morte – Crimes Contra a Vida (Homicídio) -->
      <div class="question">
        <label class="exam-label" for="local10">
          Exame em Local de Morte – Crimes Contra a Vida (Homicídio)
          <span class="info-icon" title="Investigação de cenas de homicídio, com foco em vestígios de sangue, armas, projéteis e a posição do corpo.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local10">Quantidade:</label>
          <input type="text" id="local10" name="local10" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Morte – Crimes Contra a Vida (Suicídio) -->
      <div class="question">
        <label class="exam-label" for="local11">
          Exame em Local de Morte – Crimes Contra a Vida (Suicídio)
          <span class="info-icon" title="Exame realizado em locais de suicídio para verificar a compatibilidade dos vestígios com a hipótese de autoextermínio.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local11">Quantidade:</label>
          <input type="text" id="local11" name="local11" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Morte Decorrente de Intervenção Policial -->
      <div class="question">
        <label class="exam-label" for="local12">
          Exame em Local de Morte Decorrente de Intervenção Policial
          <span class="info-icon" title="Análise de cenas onde ocorreu morte durante ações policiais, com coleta de vestígios para verificar a legitimidade do uso da força.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local12">Quantidade:</label>
          <input type="text" id="local12" name="local12" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Morte com Causa Incerta -->
      <div class="question">
        <label class="exam-label" for="local13">
          Exame em Local de Morte com Causa Incerta
          <span class="info-icon" title="Exame em locais onde a causa da morte não é evidente, buscando sinais que indiquem se foi crime, acidente ou morte natural.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local13">Quantidade:</label>
          <input type="text" id="local13" name="local13" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Aplicação de Luminol -->
      <div class="question">
        <label class="exam-label" for="local14">
          Exame de Local – Aplicação de Luminol
          <span class="info-icon" title="Técnica utilizada para revelar vestígios de sangue invisíveis a olho nu, mesmo após tentativas de limpeza.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local14">Quantidade:</label>
          <input type="text" id="local14" name="local14" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Tentativa de Homicídio -->
      <div class="question">
        <label class="exam-label" for="local15">
          Exame em Local de Tentativa de Homicídio
          <span class="info-icon" title="Investigação de cenas com tentativa de homicídio, buscando vestígios que comprovem a dinâmica do evento e identifiquem o autor.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local15">Quantidade:</label>
          <input type="text" id="local15" name="local15" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Furto Qualificado -->
      <div class="question">
        <label class="exam-label" for="local16">
          Exame em Local de Furto Qualificado
          <span class="info-icon" title="Análise de locais de furtos, com registro de marcas de arrombamento, impressões digitais e vestígios de acesso forçado.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local16">Quantidade:</label>
          <input type="text" id="local16" name="local16" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Violação de Sepultura -->
      <div class="question">
        <label class="exam-label" for="local17">
          Exame em Local de Violação de Sepultura
          <span class="info-icon" title="Investiga cenas de violação de túmulos ou sepulturas, com análise de danos, vestígios e possíveis roubos ou profanações.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local17">Quantidade:</label>
          <input type="text" id="local17" name="local17" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Crimes Contra o Patrimônio -->
      <div class="question">
        <label class="exam-label" for="local18">
          Exame em Local de Crimes Contra o Patrimônio
          <span class="info-icon" title="Abrange furtos, roubos, vandalismo e outros delitos que envolvem danos ou subtração de bens.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local18">Quantidade:</label>
          <input type="text" id="local18" name="local18" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Crimes Contra o Meio Ambiente -->
      <div class="question">
        <label class="exam-label" for="local19">
          Exame em Local de Crimes Contra o Meio Ambiente
          <span class="info-icon" title="Investigação de crimes ambientais, como desmatamento, poluição ou descarte ilegal de resíduos.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local19">Quantidade:</label>
          <input type="text" id="local19" name="local19" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Geotecnia Ambiental -->
      <div class="question">
        <label class="exam-label" for="local20">
          Exame de Geotecnia Ambiental
          <span class="info-icon" title="Avaliação técnica de solos, encostas e áreas de risco em situações de deslizamentos ou contaminação do solo.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local20">Quantidade:</label>
          <input type="text" id="local20" name="local20" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      <!-- Exame de Local: Busca e Apreensão de Vestígios Cibernéticos -->
      <div class="question">
        <label class="exam-label" for="local21">
          Busca e Apreensão de Vestígios Cibernéticos
          <span class="info-icon" title="Procedimento para coleta de dispositivos e dados eletrônicos em operações policiais, preservando informações digitais como prova.">i</span>
        </label>
        <div class="field">
          <label class="field-label" for="local21">Quantidade:</label>
          <input type="text" id="local21" name="local21" maxlength="6" pattern="\d{1,6}" inputmode="numeric"
                 oninput="this.value = this.value.replace(/\D/g, '')" required>
        </div>
      </div>
      
      <button type="submit">Enviar</button>
    </form>
    <div id="result"></div>
  </div>

  <script>
    document.getElementById("examForm").addEventListener("submit", function(event) {
      event.preventDefault();
      const formData = new FormData(this);
      let resultHTML = "<h2>Resumo das Quantidades:</h2><ul>";
      for (const [chave, valor] of formData.entries()) {
        resultHTML += `<li><strong>${chave}:</strong> ${valor}</li>`;
      }
      resultHTML += "</ul>";
      document.getElementById("result").innerHTML = resultHTML;
    });
  </script>
</body>
</html>
